<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
  <title>Dromaeo Strings Test</title>
	<script type="text/javascript" src="/jquery/json.js"></script>
	<script type="text/javascript" src="/jquery/jquery-1.5.min.js"></script>
	<script type="text/javascript" src="/migrator/migrator.php?app=benchmark_string"></script>
	<script type="text/javascript" >

function runTest(){
// Try to force real results
var ret;
var num = 80000;

// TESTS: String concatenation

		var str = "";
		for ( var i = 0; i < num; i++ )
			str += "a";
		ret = str;
		var str = new String();
		for ( var i = 0; i < num; i++ )
			str += "a";
		ret = str;
		var str = "";
		for ( var i = 0; i < num / 2; i++ )
			str += String.fromCharCode(97);
		ret = str;
		var str = [];
		for ( var i = 0; i < num / 2; i++ )
			str.push("a");
		ret = str.join("");

var ostr = [], tmp, tmp2, num = 5000, tmpstr;

for ( var i = 0; i < 16384; i++ )
	ostr.push( String.fromCharCode( (25 * Math.random()) + 97 ) );

ostr = ostr.join("");
ostr += ostr;
ostr += ostr;

var str;
var i = 52288;

		str = new String(ostr);
		ret = str.split("");
		tmpstr = str;
		tmpstr += tmpstr;
		tmpstr += tmpstr;
		tmpstr += tmpstr;
		tmpstr += tmpstr;
		ret = tmpstr.split("a");
		str += str;
		for ( var j = 0; j < num; j++ ) {
			ret = str.charAt(0);
			ret = str.charAt(str.length - 1);
			ret = str.charAt( 15000 );
			ret = str.charAt( 12000 );
		}
		for ( var j = 0; j < num; j++ ) {
			ret = str[0];
			ret = str[str.length - 1];
			ret = str[ 15000 ];
			ret = str[ 10000 ];
			ret = str[ 5000 ];
		}
		for ( var j = 0; j < num; j++ ) {
			ret = str.charCodeAt(0);
			ret = str.charCodeAt(str.length - 1);
			ret = str.charCodeAt( 15000 );
			ret = str.charCodeAt( 10000 );
			ret = str.charCodeAt( 5000 );
		}

		for ( var j = 0; j < num; j++ ) {
			ret = str.indexOf("a");
			ret = str.indexOf("b");
			ret = str.indexOf("c");
			ret = str.indexOf("d");
		}
		for ( var j = 0; j < num; j++ ) {
			ret = str.lastIndexOf("a");
			ret = str.lastIndexOf("b");
			ret = str.lastIndexOf("c");
			ret = str.lastIndexOf("d");
		}
		for ( var j = 0; j < num; j++ ) {
			ret = str.slice(0);
			ret = str.slice(0,5);
			ret = str.slice(-1);
			ret = str.slice(-6,-1);
			ret = str.slice( 15000, 15005 );
			ret = str.slice( 12000, -1 );
		}
		for ( var j = 0; j < num; j++ ) {
			ret = str.substr(0);
			ret = str.substr(0,5);
			ret = str.substr(-1);
			ret = str.substr(-6,1);
			ret = str.substr( 15000, 5 );
			ret = str.substr( 12000, 5 );
		}
		for ( var j = 0; j < num; j++ ) {
			ret = str.substring(0);
			ret = str.substring(0,5);
			ret = str.substring(-1);
			ret = str.substring(-6,-1);
			ret = str.substring( 15000, 15005 );
			ret = str.substring( 12000, -1 );
		}
		for ( var j = 0; j < num / 1000; j++ ) {
			ret = str.toLowerCase();
		}
		for ( var j = 0; j < num / 1000; j++ ) {
			ret = str.toUpperCase();
		}
		tmp = str;
		tmp2 = str;
		tmp = "a" + tmp + "a";
		tmp2 = "a" + tmp2 + "a";
		for ( var j = 0; j < num / 1000; j++ ) {
			ret = tmp == tmp2;
			ret = tmp < tmp2;
			ret = tmp > tmp2;
		}

};
	</script>

</head>
<body>
	<h2>Dromaeo Strings Test</h2><br/>
	<button class="run1" style="display:block;margin-top:40px;height:40px;width:150px;font-size:20px;" >Start Test</button><label id="label1" style="display:auto;"></label><br/>
	
	<script type="text/javascript" >
		$(".run1").click(function(event){
				var startTime=new Date().getTime();
				runTest();
				var timeConsume=new Date().getTime()-startTime;
				document.getElementById("label1").innerHTML="Time Consuming:"+timeConsume.toString()+"ms";
		});

	</script>

</body></html>

